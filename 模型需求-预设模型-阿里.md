预设 1：阿里巴巴通义·百炼（DashScope）
好的，我们来分别看一下通义万相（Wanx）和 Qwen3 文生图模型的 API 要求。

---

### **1. 通义万相 (Wanx) 模型**

通义万相是阿里云 DashScope 平台提供的一个强大的文本到图像生成服务。它的主要特点和API要求如下：

#### **核心功能**
*   **文生图 (Text-to-Image Generation)**: 根据纯文本描述生成全新的图像。
*   **图像风格迁移**: 将一张图像转换成另一种艺术风格。
*   **人物写真**: 生成特定类型的人物肖像。
*   **图像放大增强**: 提高清晰度或分辨率。

#### **RESTful API 调用方式**

**基础 URL:** `https://dashscope.aliyuncs.com/api/v1/services/aigc/text2image/image_synthesis`

**HTTP 方法:** `POST`

**认证方式:** 使用 HTTP Header `Authorization: bearer <your_api_key>`，其中 `<your_api_key>` 是你在阿里云控制台获取的 API Key。

**Content-Type:** `application/json`

#### **请求体 (Request Body - JSON)**

| 字段名 | 类型 | 是否必须 | 描述 |
| :--- | :--- | :--- | :--- |
| `model` | String | 否 | 指定使用的模型版本。例如 `"wanx-v1"` 或 `"alt_diffusion_v2"`。如果不指定，系统会选择默认模型。 |
| `input.prompt` | String | **是** | 用于生成图像的主要文本提示词。这是最核心的输入。 |
| `input.negative_prompt` | String | 否 | 不希望在生成图像中出现的内容的反向提示词。 |
| `parameters.size` | String | 否 | 生成图像的尺寸。可选项包括 `"1024*1024"`, `"720*1280"`, `"1280*720"`。默认为 `"1024*1024"`。 |
| `parameters.n` | Integer | 否 | 请求生成的图像数量。范围通常是 `[1, 4]`。默认为 `1`。 |
| `parameters.seed` | Integer | 否 | 随机种子，用于复现相同的生成结果。如果省略，则每次都会产生不同的随机种子。 |
| `parameters.style` | String | 否 | 图像风格预设。具体可用值需查阅官方文档。 |
| `parameters.model_version` | String | 否 | 特指某些高级功能或特定版本的模型标识符。 |

#### **cURL 示例**

```bash
curl -X POST "https://dashscope.aliyuncs.com/api/v1/services/aigc/text2image/image_synthesis" \
     -H "Authorization: bearer YOUR_DASHSCOPE_API_KEY" \
     -H "Content-Type: application/json" \
     -d '{
           "model": "wanx-v1",
           "input": {
             "prompt": "一只穿着太空服的猫，在月球上跳跃。",
             "negative_prompt": "模糊，低质量"
           },
           "parameters": {
             "size": "1024*1024",
             "n": 1,
             "seed": 12345
           }
         }'
```

#### **响应 (Response)**

成功调用后，你会收到一个包含任务ID (`task_id`) 的JSON响应。你需要使用此 ID 查询任务状态以获取最终结果。

查询任务状态的接口通常也是 RESTful 的，比如：
`GET /api/v1/tasks/{task_id}`

当任务完成后，最终返回会包含生成图像的 URL 地址列表。

---

### **2. Qwen3 文生图模型**

好的，我们来讨论一下 Qwen3 多模态大语言模型（Multimodal LLM）中涉及图像生成的部分，特别是能返回图像和文字的 API 模型。

正如之前提到的，Qwen3 本身是一个强大的语言模型，但其多模态能力允许它处理和生成多种类型的内容，包括文本和图像。然而，Qwen3 本身**通常不直接生成原始的图像像素数据**。相反，它更像是一个“指挥官”，能够理解你的需求，并调用后端专门的图像生成模型（如通义万相 Wanx）来完成实际的绘图任务。

### Qwen3 多模态 API (能返回图文的模型)

#### 核心功能
*   **多轮对话**: 支持基于文本和图像的上下文进行多轮交互。
*   **视觉理解**: 分析和理解输入的图像内容。
*   **图文生成**: 根据文本指令生成图像（通过调用内部或外部的图像生成服务）并返回结果（文字描述 + 图像链接）。

#### RESTful API 调用方式

**基础 URL:** 这取决于你通过哪个平台或服务访问 Qwen3。例如，如果你使用阿里云百炼平台（ModelScope）或 DashScope，URL 会不同。通常，这类 API 会有一个统一的入口点用于调用不同的模型。

一个常见的模式（以 DashScope 为例）是：
`https://dashscope.aliyuncs.com/api/v1/services/aigc/xxx` （具体路径请查阅官方文档）

**HTTP 方法:** `POST`

**认证方式:** 使用 HTTP Header `Authorization: bearer <your_api_key>`，其中 `<your_api_key>` 是你在对应平台获取的 API Key。

**Content-Type:** `application/json`

#### 请求体 (Request Body - JSON)

虽然具体的字段可能因平台而异，但一般会包含以下核心部分：

| 字段名 | 类型 | 是否必须 | 描述 |
| :--- | :--- | :--- | :--- |
| `model` | String | **是** | 指定要使用的模型名称。对于 Qwen3 多模态，这可能是类似 `"qwen-vl-plus"`、`"qwen-vl-max"` 或者直接是 `"qwen3-vl"` 这样的标识符。具体名称请参考官方文档。 |
| `input.messages` | Array of Objects | **是** | 包含对话历史和当前请求的消息列表。每个消息对象通常包含 `role` (如 "user", "assistant") 和 `content`。`content` 可以是纯文本，也可以是包含文本和图像信息的复杂结构。 |
| `input.messages[].content` | Array of Objects or String | **是** | 单条消息的具体内容。如果是数组，则可以混合文本和图像。 |
| `input.messages[].content[].text` | String | 否 | 文本内容。 |
| `input.messages[].content[].image` | String | 否 | 图像的 URL 或 Base64 编码字符串。 |
| `parameters` | Object | 否 | 模型运行时的一些可选参数，例如 `seed`, `temperature` 等，用于控制生成行为。 |

#### **cURL 示例 (以 DashScope 平台假设的 Qwen3-VL 模型为例)**

```bash
curl -X POST "https://dashscope.aliyuncs.com/api/v1/services/aigc/text2image/image_synthesis" \
     -H "Authorization: bearer YOUR_DASHSCOPE_API_KEY" \
     -H "Content-Type: application/json" \
     -H "X-DashScope-Async: enable" \ # 如果需要异步处理，可能需要此头
     -d '{
           "model": "qwen3-vl", // 假设的模型名，请替换为实际名称
           "input": {
             "messages": [
               {
                 "role": "user",
                 "content": [
                   {
                     "text": "请根据以下描述生成一幅图像：一只穿着太空服的猫，在月球上跳跃。风格要卡通一点。"
                   }
                 ]
               }
             ]
           },
           "parameters": {
             "seed": 12345
           }
         }'
```

**注意:** 上面的 URL 和模型名是假设性的，用于说明结构。你需要查阅阿里云 DashScope 或相关平台的官方文档来获取准确的模型名称和 API 端点。

#### **响应 (Response)**

响应结构同样取决于平台。对于生成图像的任务，响应通常会包含：

*   **任务状态信息**: 如果是异步调用，会返回一个 `task_id` 用于查询。
*   **最终结果**: 当任务完成时，结果可能包含：
    *   `output.text`: 模型返回的文字内容（例如对图像的描述或确认信息）。
    *   `output.image_url` 或 `output.images`: 生成的图像的 URL 列表。

例如（假设性响应）：

```json
{
  "request_id": "xxx",
  "output": {
    "text": "好的，我已经为您生成了图像。",
    "images": [
      "https://example.com/generated_image_1.png"
    ]
  }
}
```

或者对于异步任务：

```json
{
  "request_id": "xxx",
  "task_id": "yyy",
  "task_status": "QUEUED" // 或 RUNNING, SUCCEEDED, FAILED
}
```

你需要根据 `task_status` 来决定是否需要再次查询任务结果。

### 总结

1.  **Qwen3 多模态模型** 本身是一个强大的语言和视觉理解模型。
2.  它可以通过 API 接收包含文本（甚至图像）的请求，并返回文本和/或图像。
3.  实际的图像生成**很可能**是通过调用后端专门的图像生成服务（如 Wanx）完成的。
4.  具体的 API 端点、模型名称 (`model`) 和参数细节需要查阅你所使用的平台（如阿里云 DashScope）的官方文档。

如果你能提供你打算使用的具体平台或服务名称，我可以给出更精确的指导。

A) OpenAI 兼容模式（推荐，最省事）
	•	Base URL：https://dashscope.aliyuncs.com/compatible-mode/v1
	•	Path Template：{{baseUrl}}/chat/completions
	•	Auth Type：Bearer → Authorization: Bearer {{apiKey}}
	•	Streaming：OpenAI SSE
	•	Response Mapping：
	•	文本：choices[0].message.content
	•	工具：choices[*].message.tool_calls
	•	结束：choices[0].finish_reason

说明：这是百炼官方提供的 OpenAI 兼容入口，路径与返回结构和 OpenAI 一致，可直接用你现有的请求体与流式解析
当您通过OpenAI SDK或其他OpenAI兼容的SDK调用时，需要配置的BASE_URL如下： 
新加坡：https://dashscope-intl.aliyuncs.com/compatible-mode/v1
华北2（北京）：https://dashscope.aliyuncs.com/compatible-mode/v1

当您通过HTTP请求调用时，需要配置的完整访问endpoint如下： 
新加坡：POST https://dashscope-intl.aliyuncs.com/compatible-mode/v1/chat/completions
华北2（北京）：POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions

模型分类

模型名称

通义千问

qwen-max

qwen-max-latest

qwen-max-2025-01-25

qwen-plus

qwen-plus-latest

qwen-plus-2025-04-28

qwen-plus-2025-01-25

qwen-turbo

qwen-turbo-latest

qwen-turbo-2025-04-28

qwen-turbo-2024-11-01

通义千问开源系列

qwq-32b

qwen3-235b-a22b

qwen3-32b

qwen3-30b-a3b

qwen3-14b

qwen3-8b

qwen3-4b

qwen3-1.7b

qwen3-0.6b

qwen2.5-14b-instruct-1m

qwen2.5-7b-instruct-1m

qwen2.5-72b-instruct

qwen2.5-32b-instruct

qwen2.5-14b-instruct

qwen2.5-7b-instruct

qwen2-72b-instruct

qwen2-7b-instruct

qwen1.5-110b-chat

qwen1.5-72b-chat

qwen1.5-32b-chat

qwen1.5-14b-chat

qwen1.5-7b-chat


通过OpenAI SDK调用
前提条件
请确保您的计算机上安装了Python环境。

请安装最新版OpenAI SDK。

 
# 如果下述命令报错，请将pip替换为pip3
pip install -U openai
您需要开通阿里云百炼模型服务并获得API-KEY，详情请参考：获取API Key。

我们推荐您将API-KEY配置到环境变量中以降低API-KEY的泄露风险，配置方法可参考配置API Key到环境变量。您也可以在代码中配置API-KEY，但是泄露风险会提高。

请选择您需要使用的模型：支持的模型列表。

使用方式
您可以参考以下示例来使用OpenAI SDK访问百炼服务上的通义千问模型。

非流式调用示例
 
from openai import OpenAI
import os

def get_response():
    client = OpenAI(
        api_key=os.getenv("DASHSCOPE_API_KEY"),  # 如果您没有配置环境变量，请用阿里云百炼API Key将本行替换为：api_key="sk-xxx"
        # 填写DashScope SDK的base_url，如果使用华北2（北京）地域的模型，需要将url替换为：https://dashscope.aliyuncs.com/compatible-mode/v1
        base_url="https://dashscope-intl.aliyuncs.com/compatible-mode/v1",  
    )
    completion = client.chat.completions.create(
        model="qwen-plus",  # 此处以qwen-plus为例，可按需更换模型名称。模型列表：https://www.alibabacloud.com/help/zh/model-studio/getting-started/models
        messages=[{'role': 'system', 'content': 'You are a helpful assistant.'},
                  {'role': 'user', 'content': '你是谁？'}]
        )
    print(completion.model_dump_json())

if __name__ == '__main__':
    get_response()
运行代码可以获得以下结果：

 
{
    "id": "chatcmpl-xxx",
    "choices": [
        {
            "finish_reason": "stop",
            "index": 0,
            "logprobs": null,
            "message": {
                "content": "我是来自阿里云的超大规模预训练模型，我叫通义千问。",
                "role": "assistant",
                "function_call": null,
                "tool_calls": null
            }
        }
    ],
    "created": 1716430652,
    "model": "qwen-plus",
    "object": "chat.completion",
    "system_fingerprint": null,
    "usage": {
        "completion_tokens": 18,
        "prompt_tokens": 22,
        "total_tokens": 40
    }
}
流式调用示例
 
from openai import OpenAI
import os


def get_response():
    client = OpenAI(
        # 如果您没有配置环境变量，请用阿里云百炼API Key将下行替换为：api_key="sk-xxx"
        api_key=os.getenv("DASHSCOPE_API_KEY"),
        # 填写DashScope SDK的base_url，如果使用华北2（北京）地域的模型，需要将url替换为：https://dashscope.aliyuncs.com/compatible-mode/v1
        base_url="https://dashscope-intl.aliyuncs.com/compatible-mode/v1",
        
    )
    completion = client.chat.completions.create(
        model="qwen-plus",  # 此处以qwen-plus为例，可按需更换模型名称。模型列表：https://www.alibabacloud.com/help/zh/model-studio/getting-started/models
        messages=[{'role': 'system', 'content': 'You are a helpful assistant.'},
                  {'role': 'user', 'content': '你是谁？'}],
        stream=True,
        # 通过以下设置，在流式输出的最后一行展示token使用信息
        stream_options={"include_usage": True}
        )
    for chunk in completion:
        print(chunk.model_dump_json())


if __name__ == '__main__':
    get_response()
运行代码可以获得以下结果：

 
{"id":"chatcmpl-xxx","choices":[{"delta":{"content":"","function_call":null,"role":"assistant","tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":null}
{"id":"chatcmpl-xxx","choices":[{"delta":{"content":"我是","function_call":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":null}
{"id":"chatcmpl-xxx","choices":[{"delta":{"content":"来自","function_call":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":null}
{"id":"chatcmpl-xxx","choices":[{"delta":{"content":"阿里","function_call":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":null}
{"id":"chatcmpl-xxx","choices":[{"delta":{"content":"云的大规模语言模型","function_call":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":null}
{"id":"chatcmpl-xxx","choices":[{"delta":{"content":"，我叫通义千问。","function_call":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":null}
{"id":"chatcmpl-xxx","choices":[{"delta":{"content":"","function_call":null,"role":null,"tool_calls":null},"finish_reason":"stop","index":0,"logprobs":null}],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":null}
{"id":"chatcmpl-xxx","choices":[],"created":1719286190,"model":"qwen-plus","object":"chat.completion.chunk","system_fingerprint":null,"usage":{"completion_tokens":16,"prompt_tokens":22,"total_tokens":38}}



输入参数配置
输入参数与OpenAI的接口参数对齐，当前已支持的参数如下：





参数

类型

默认值

说明

model

string

-

用户使用model参数指明对应的模型，可选的模型请见支持的模型列表。

messages

array

-

用户与模型的对话历史。array中的每个元素形式为{"role":角色, "content": 内容}。角色当前可选值：system、user、assistant，其中，仅messages[0]中支持role为system，一般情况下，user和assistant需要交替出现，且messages中最后一个元素的role必须为user。

top_p（可选）

float

-

生成过程中的核采样方法概率阈值，例如，取值为0.8时，仅保留概率加起来大于等于0.8的最可能token的最小集合作为候选集。取值范围为（0,1.0)，取值越大，生成的随机性越高；取值越小，生成的确定性越高。

temperature（可选）

float

-

用于控制模型回复的随机性和多样性。具体来说，temperature值控制了生成文本时对每个候选词的概率分布进行平滑的程度。较高的temperature值会降低概率分布的峰值，使得更多的低概率词被选择，生成结果更加多样化；而较低的temperature值则会增强概率分布的峰值，使得高概率词更容易被选择，生成结果更加确定。

取值范围： [0, 2)，不建议取值为0，无意义。

presence_penalty

（可选）

float

-

用户控制模型生成时整个序列中的重复度。提高presence_penalty时可以降低模型生成的重复度，取值范围[-2.0, 2.0]。

说明
目前仅在千问商业模型和qwen1.5及以后的开源模型上支持该参数。

n（可选）

integer

1

生成响应的个数，取值范围是1-4。对于需要生成多个响应的场景（如创意写作、广告文案等），可以设置较大的 n 值。

设置较大的 n 值不会增加输入 Token 消耗，会增加输出 Token 的消耗。
当前仅支持 qwen-plus 模型，且在传入 tools 参数时固定为1。
max_tokens（可选）

integer

-

指定模型可生成的最大token个数。例如模型最大输出长度为2k，您可以设置为1k，防止模型输出过长的内容。

不同的模型有不同的输出上限，具体请参见模型列表。

seed（可选）

integer

-

生成时使用的随机数种子，用于控制模型生成内容的随机性。seed支持无符号64位整数。

stream（可选）

boolean

False

用于控制是否使用流式输出。当以stream模式输出结果时，接口返回结果为generator，需要通过迭代获取结果，每次输出为当前生成的增量序列。

stop（可选）

string or array

None

stop参数用于实现内容生成过程的精确控制，在模型生成的内容即将包含指定的字符串或token_id时自动停止。stop可以为string类型或array类型。

string类型

当模型将要生成指定的stop词语时停止。

例如将stop指定为"你好"，则模型将要生成“你好”时停止。

array类型

array中的元素可以为token_id或者字符串，或者元素为token_id的array。当模型将要生成的token或其对应的token_id在stop中时，模型生成将会停止。以下为stop为array时的示例（tokenizer对应模型为qwen-turbo）：

1.元素为token_id：

token_id为108386和104307分别对应token为“你好”和“天气”，设定stop为[108386,104307]，则模型将要生成“你好”或者“天气”时停止。

2.元素为字符串：

设定stop为["你好","天气"]，则模型将要生成“你好”或者“天气”时停止。

3.元素为array：

token_id为108386和103924分别对应token为“你好”和“啊”，token_id为35946和101243分别对应token为“我”和“很好”。设定stop为[[108386, 103924],[35946, 101243]]，则模型将要生成“你好啊”或者“我很好”时停止。

说明
stop为array类型时，不可以将token_id和字符串同时作为元素输入，比如不可以指定stop为["你好",104307]。

tools（可选）

array

None

用于指定可供模型调用的工具库，一次function call流程模型会从中选择其中一个工具。tools中每一个tool的结构如下：

type，类型为string，表示tools的类型，当前仅支持function。

function，类型为object，键值包括name，description和parameters：

name：类型为string，表示工具函数的名称，必须是字母、数字，可以包含下划线和短划线，最大长度为64。

description：类型为string，表示工具函数的描述，供模型选择何时以及如何调用工具函数。

parameters：类型为object，表示工具的参数描述，需要是一个合法的JSON Schema。JSON Schema的描述可以见链接。如果parameters参数为空，表示function没有入参。

在function call流程中，无论是发起function call的轮次，还是向模型提交工具函数的执行结果，均需设置tools参数。当前支持的模型包括qwen-turbo、qwen-plus和qwen-max。

说明
tools暂时无法与stream=True同时使用。

stream_options（可选）

object

None

该参数用于配置在流式输出时是否展示使用的token数目。只有当stream为True的时候该参数才会激活生效。若您需要统计流式输出模式下的token数目，可将该参数配置为stream_options={"include_usage":True}。


1）通义千问-chat：
通义千问API参考
更新时间：2025-10-11 11:56
产品详情
社区
本文介绍通义千问 API 的输入输出参数。

模型介绍、选型建议和使用方法，请参考文本生成模型概述。
您可以通过 OpenAI 兼容或 DashScope 的方式调用通义千问 API。

OpenAI 兼容
新加坡地域北京地域
使用SDK调用时需配置的base_url：https://dashscope-intl.aliyuncs.com/compatible-mode/v1

使用HTTP方式调用时需配置的endpoint：POST https://dashscope-intl.aliyuncs.com/compatible-mode/v1/chat/completions

您需要已获取API Key并配置API Key到环境变量。如果通过OpenAI SDK进行调用，还需要安装SDK。

请求体：
1）文本输入
新加坡和北京地域的API Key不同。获取API Key：https://www.alibabacloud.com/help/zh/model-studio/get-api-key。若使用北京地域的模型，需将url替换为：https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions
 
curl -X POST https://dashscope-intl.aliyuncs.com/compatible-mode/v1/chat/completions \
-H "Authorization: Bearer $DASHSCOPE_API_KEY" \
-H "Content-Type: application/json" \
-d '{
    "model": "qwen-plus",
    "messages": [
        {
            "role": "system",
            "content": "You are a helpful assistant."
        },
        {
            "role": "user", 
            "content": "你是谁？"
        }
    ]
}'


2）流失输出：
curl --location "https://dashscope-intl.aliyuncs.com/compatible-mode/v1/chat/completions" \
--header "Authorization: Bearer $DASHSCOPE_API_KEY" \
--header "Content-Type: application/json" \
--data '{
    "model": "qwen-plus",
    "messages": [
        {
            "role": "system",
            "content": "You are a helpful assistant."
        },
        {
            "role": "user", 
            "content": "你是谁？"
        }
    ],
    "stream":true
}'
3）图像输出
curl -X POST https://dashscope-intl.aliyuncs.com/compatible-mode/v1/chat/completions \
-H "Authorization: Bearer $DASHSCOPE_API_KEY" \
-H 'Content-Type: application/json' \
-d '{
  "model": "qwen-vl-plus",
  "messages": [{
      "role": "user",
      "content": [
       {"type": "image_url","image_url": {"url": "https://dashscope.oss-cn-beijing.aliyuncs.com/images/dog_and_girl.jpeg"}},
       {"type": "text","text": "这是什么"}
       ]}]
}'

字段解释：
model string （必选）

模型名称。

支持的模型：通义千问大语言模型（商业版、开源版）、通义千问VL、代码模型。

具体模型名称和计费，请参见模型列表。

messages array （必选）

由历史对话组成的消息列表。

消息类型

System Message object （可选）

模型的目标或角色。如果设置系统消息，请放在messages列表的第一位。

属性

content string （必选）

消息内容。

role string （必选）

固定为system。

QwQ 、Qwen3-VL模型不建议设置 System Message，QVQ 模型设置System Message不会生效。
User Message object （必选）

用户发送给模型的消息。

属性

content string 或 array （必选）

消息内容。如果您的输入只有文本，则为 string 类型；如果您的输入包含图像等多模态数据，则为 array 类型。

使用多模态模型时的属性

role string （必选）

固定为user。

Assistant Message object （可选）

模型对用户消息的回复。

属性

content string （可选）

消息内容。仅当助手消息中指定tool_calls参数时非必选。

role string （必选）

固定为assistant。

partial boolean （可选）

是否开启Partial Mode。使用方法请参考前缀续写。

支持的模型

tool_calls array （可选）

在发起 Function Calling后，模型回复的要调用的工具和调用工具时需要的参数。包含一个或多个对象。由上一轮模型响应的tool_calls字段获得。

属性

id string

本次工具响应的ID。

type string

工具的类型，当前只支持function。

function object

需要被调用的函数。

属性

index integer

工具信息在tool_calls列表中的索引。

Tool Message object （可选）

工具的输出信息。

属性

content string （必选）

消息内容，一般为工具函数的输出。

role string （必选）

固定为tool。

tool_call_id string （可选）

发起 Function Calling 后返回的 id，可以通过completion.choices[0].message.tool_calls[0].id获取，用于标记 Tool Message 对应的工具。

stream boolean （可选） 默认值为 false

是否流式输出回复。参数值：

false：模型生成完所有内容后一次性返回结果。

true：边生成边输出，即每生成一部分内容就立即输出一个片段（chunk）。您需要实时地逐个读取这些片段以获得完整的结果。

Qwen3商业版（思考模式）、Qwen3开源版、QwQ、QVQ只支持流式输出。
stream_options object （可选）

当启用流式输出时，可通过将本参数设置为{"include_usage": true}，在输出的最后一行显示所使用的Token数。

如果设置为false，则最后一行不显示使用的Token数。
本参数仅在设置stream为true时生效。

modalities array （可选）默认值为["text"]

输出数据的模态，仅支持 Qwen-Omni 模型指定。可选值：

["text","audio"]：输出文本与音频；

["text"]：输出文本。

audio object （可选）

输出音频的音色与格式，仅支持 Qwen-Omni 模型，且modalities参数需要包含"audio"。

属性

voice string （必选）

输出音频的音色，可选值：

Ethan

Chelsie

音色效果请参见：全模态。

format string （必选）

输出音频的格式，当前仅支持设定为"wav"。

temperature float （可选）

采样温度，控制模型生成文本的多样性。

temperature越高，生成的文本更多样，反之，生成的文本更确定。

取值范围： [0, 2)

由于temperature与top_p均可以控制生成文本的多样性，因此建议您只设置其中一个值。更多说明，请参见文本生成模型概述。

不建议修改QVQ模型的默认temperature值 。
top_p float （可选）

核采样的概率阈值，控制模型生成文本的多样性。

top_p越高，生成的文本更多样。反之，生成的文本更确定。

取值范围：（0,1.0]

由于temperature与top_p均可以控制生成文本的多样性，因此建议您只设置其中一个值。更多说明，请参见文本生成模型概述。

不建议修改QVQ模型的默认 top_p 值。
top_k integer （可选）

生成过程中采样候选集的大小。例如，取值为50时，仅将单次生成中得分最高的50个Token组成随机采样的候选集。取值越大，生成的随机性越高；取值越小，生成的确定性越高。取值为None或当top_k大于100时，表示不启用top_k策略，此时仅有top_p策略生效。

取值需要大于或等于0。

top_k默认值

QVQ系列、qwen-vl-plus-2025-07-10、qwen-vl-plus-2025-08-15：10；

QwQ 系列：40；

其余qwen-vl-plus系列、qwen-vl-max-2025-08-13之前的模型、qwen-vl-ocr、qwen2.5-omni-7b：1；

Qwen3-Omni-Flash系列：50

其余模型均为20；

通过 Python SDK调用时，请将 top_k 放入 extra_body 对象中，配置方式为：extra_body={"top_k":xxx}。
不建议修改QVQ模型的默认 top_k 值。
presence_penalty float （可选）

控制模型生成文本时的内容重复度。

取值范围：[-2.0, 2.0]。正数会减少重复度，负数会增加重复度。

适用场景：

较高的presence_penalty适用于要求多样性、趣味性或创造性的场景，如创意写作或头脑风暴。

较低的presence_penalty适用于要求一致性或专业术语的场景，如技术文档或其他正式文档。

presence_penalty默认值

Qwen3（非思考模式）、Qwen3-Instruct系列、qwen3-0.6b/1.7b/4b（思考模式）、QVQ系列、qwen-max、qwen-max-latest、qwen-max-latestqwen2.5-vl系列、qwen-vl-max系列、qwen-vl-plus、Qwen3-VL（非思考）：1.5；

qwen-vl-plus-latest、qwen-vl-plus-2025-08-15：1.2

qwen-vl-plus-2025-01-25：1.0；

qwen3-8b/14b/32b/30b-a3b/235b-a22b（思考模式）、qwen-plus/qwen-plus-latest/2025-04-28（思考模式）、qwen-turbo/qwen-turbo/2025-04-28（思考模式）：0.5；

其余均为0.0。

原理介绍

示例

使用qwen-vl-plus-2025-01-25模型进行文字提取时，建议设置presence_penalty为1.5。
不建议修改QVQ模型的默认presence_penalty值。
response_format object （可选） 默认值为{"type": "text"}

返回内容的格式。可选值：{"type": "text"}或{"type": "json_object"}。设置为{"type": "json_object"}时会输出标准格式的JSON字符串。使用方法请参见：结构化输出。

如果指定该参数为{"type": "json_object"}，您需要在System Message或User Message中指引模型输出JSON格式，如：“请按照json格式输出。”
支持的模型

通义千问Max 系列：qwen3-max、qwen3-max-2025-09-23、qwen3-max-preview、qwen-max、qwen-max-latest、qwen-max-2025-01-25 及之后的快照模型

通义千问Plus 系列（非思考模式）：qwen-plus、qwen-plus-latest、qwen-plus-2025-01-25及之后的快照模型

通义千问Flash 系列（非思考模式）：qwen-flash、qwen-flash-2025-07-28及之后的快照模型

通义千问Coder 系列：qwen3-coder-plus、qwen3-coder-plus-2025-07-22、qwen3-coder-flash、qwen3-coder-flash-2025-07-28

通义千问Turbo 系列（非思考模式）：qwen-turbo、qwen-turbo-latest、qwen-turbo-2024-11-01及之后的快照模型

Qwen 开源系列

Qwen3（非思考模式）

Qwen3-Coder

Qwen2.5 系列的文本模型（不含math与coder模型）

max_input_tokens integer （可选）

允许输入的最大 Token 长度。目前仅支持qwen-plus-0728/latest模型。

qwen-plus-latest 默认值：129,024

后续默认值可能调整至1,000,000。
qwen-plus-2025-07-28 默认值：1,000,000

通过 Python SDK 调用时，请通过extra_body配置。配置方式为：extra_body={"max_input_tokens": xxx}。
max_tokens integer （可选）

本次请求返回的最大 Token 数。

max_tokens 的设置不会影响大模型的生成过程，如果模型生成的 Token 数超过max_tokens，本次请求会返回截断后的内容。
默认值和最大值都是模型的最大输出长度。关于各模型的最大输出长度，请参见模型列表。

max_tokens参数适用于需要限制字数（如生成摘要、关键词）、控制成本或减少响应时间的场景。

qwen-vl-ocr模型的max_tokens参数（最大输出长度）默认为 4096，如需提高该参数值（4097~8192范围），请发送邮件至 modelstudio@service.aliyun.com进行申请，并提供以下信息：主账号ID、图像类型（如文档图、电商图、合同等）、模型名称、预计 QPS 和每日请求总数，以及模型输出长度超过4096的请求占比。
对于 QwQ、QVQ 与开启思考模式的 Qwen3 模型，max_tokens会限制回复内容的长度，不限制深度思考内容的长度。
vl_high_resolution_images boolean （可选）默认值为false

是否提高输入图片的默认Token上限，适用于Qwen-VL、QVQ模型。

False（默认值）：使用默认的Token处理图像

Qwen3-VL商业版及开源版、qwen-vl-max-0813及以后、qwen-vl-plus-0815及以后更新的模型：默认Token上限为2560

：默认Token上限为1280

True：输入图片的Token上限将提高为16384

通过 Python SDK调用时，请将 vl_high_resolution_images 放入 extra_body 对象中，配置方式为：extra_body={"vl_high_resolution_images":xxx}。
n integer （可选） 默认值为1

生成响应的个数，取值范围是1-4。对于需要生成多个响应的场景（如创意写作、广告文案等），可以设置较大的 n 值。

当前仅支持 qwen-plus、 Qwen3（非思考模式） 模型，且在传入 tools 参数时固定为1。
设置较大的 n 值不会增加输入 Token 消耗，会增加输出 Token 的消耗。
enable_thinking boolean （可选）

是否开启思考模式，适用于 Qwen3 、Qwen3-Omni-Flash、Qwen3-VL模型。

Qwen3 商业版模型默认值为 False，Qwen3 开源版模型默认值为 True。

通过 Python SDK 调用时，请通过extra_body配置。配置方式为：extra_body={"enable_thinking": xxx}。
thinking_budget integer （可选）

思考过程的最大长度，只在enable_thinking为true时生效。适用于Qwen3-VL、Qwen3 的商业版与开源版模型。详情请参见限制思考长度。

默认值为模型最大思维链长度。
通过 Python SDK 调用时，请通过extra_body配置。配置方式为：extra_body={"thinking_budget": xxx}。
seed integer （可选）

设置seed参数会使文本生成过程更具有确定性，通常用于使模型每次运行的结果一致。

在每次模型调用时传入相同的seed值（由您指定），并保持其他参数不变，模型将尽可能返回相同的结果。

取值范围：0到231−1。

logprobs boolean （可选）默认值为 false

是否返回输出 Token 的对数概率，可选值：

true

返回；

false

不返回。

思考阶段生成的内容（reasoning_content）不会返回对数概率。
支持 qwen-plus、qwen-turbo 系列的快照模型（不包含主线模型）与 Qwen3 开源模型。
top_logprobs integer （可选）默认值为0

指定在每一步生成时，返回模型最大概率的候选 Token 个数。

取值范围：[0,5]

仅当 logprobs 为 true 时生效。

stop string 或 array （可选）

使用stop参数后，当模型生成的文本即将包含指定的字符串或token_id时，将自动停止生成。

您可以在stop参数中传入敏感词来控制模型的输出。

stop为array类型时，不可以将token_id和字符串同时作为元素输入，比如不可以指定stop为["你好",104307]。
tools array （可选）

可供模型调用的工具数组，可以包含一个或多个工具对象。一次Function Calling流程模型会从中选择一个工具（开启parallel_tool_calls可以选择多个工具）。

目前不支持通义千问VL。
属性

tool_choice string 或 object （可选）默认值为 "auto"

如果您希望对于某一类问题，大模型能够采取制定好的工具选择策略（如强制使用某个工具、强制不使用工具），可以通过修改tool_choice参数来强制指定工具调用的策略。可选值：

"auto"

表示由大模型进行工具策略的选择。

"none"

如果您希望无论输入什么问题，Function Calling 都不会进行工具调用，可以设定tool_choice参数为"none"；

{"type": "function", "function": {"name": "the_function_to_call"}}

如果您希望对于某一类问题，Function Calling 能够强制调用某个工具，可以设定tool_choice参数为{"type": "function", "function": {"name": "the_function_to_call"}}，其中the_function_to_call是您指定的工具函数名称。

若模型输出思考过程，则不支持设置为该值。
parallel_tool_calls boolean （可选）默认值为 false

是否开启并行工具调用。参数为true时开启，为false时不开启。并行工具调用详情请参见：并行工具调用。

translation_options object （可选）

当您使用翻译模型时需要配置的翻译参数。

属性

若您通过Python SDK调用，请通过extra_body配置。配置方式为：extra_body={"translation_options": xxx}。
chat响应对象（非流式输出）
 
{
    "choices": [
        {
            "message": {
                "role": "assistant",
                "content": "我是阿里云开发的一款超大规模语言模型，我叫通义千问。"
            },
            "finish_reason": "stop",
            "index": 0,
            "logprobs": null
        }
    ],
    "object": "chat.completion",
    "usage": {
        "prompt_tokens": 3019,
        "completion_tokens": 104,
        "total_tokens": 3123,
        "prompt_tokens_details": {
            "cached_tokens": 2048
        }
    },
    "created": 1735120033,
    "system_fingerprint": null,
    "model": "qwen-plus",
    "id": "chatcmpl-6ada9ed2-7f33-9de2-8bb0-78bd4035025a"
}
id string

本次调用的唯一标识符。

choices array

模型生成内容的数组，可以包含一个或多个choices对象。

属性

finish_reason string

有三种情况：

因触发输入参数中的stop条件，或自然停止输出时为stop；

因生成长度过长而结束为length；

因需要调用工具而结束为tool_calls。

index integer

当前响应在choices数组中的序列编号。

logprobs object

当前 choices 对象的概率信息。

属性

content array

带有对数概率信息的 Token 数组。

属性

token string

当前 Token。

bytes array

当前 Token 的 UTF‑8 原始字节列表，用于精确还原输出内容，在处理表情符号、中文字符时有帮助。

logprob float

当前 Token 的对数概率。返回值为 null 表示概率值极低。

top_logprobs array

当前 Token 位置最可能的若干个 Token 及其对数概率，元素个数与入参的top_logprobs保持一致。

属性

token string

当前 Token。

bytes array

当前 Token 的 UTF‑8 原始字节列表，用于精确还原输出内容，在处理表情符号、中文字符时有帮助。

logprob float

当前 Token 的对数概率。返回值为 null 表示概率值极低。

message object

本次调用模型输出的消息。

属性

content string

本次调用模型生成的文本。

reasoning_content string

模型的思维链内容。

refusal string

该参数当前固定为null。

role string

消息的角色，固定为assistant。

audio object

该参数当前固定为null。

function_call（即将废弃）object

该值默认为null，请参考tool_calls参数。

tool_calls array

在发起 Function Calling后，模型回复的要调用的工具以及调用工具所需的参数。可以包含一个或多个工具响应对象。

属性

id string

本次工具响应的ID。

type string

工具的类型，当前只支持function。

function object

需要被调用的函数。

属性

index integer

工具信息在tool_calls列表中的索引。

created integer

本次chat请求被创建时的时间戳。

model string

本次chat请求使用的模型名称。

object string

始终为chat.completion。

service_tier string

该参数当前固定为null。

system_fingerprint string

该参数当前固定为null。

usage object

本次chat请求使用的 Token 信息。

属性

completion_tokens integer

模型生成回复转换为 Token 后的长度。

prompt_tokens integer

用户的输入转换成 Token 后的长度。

total_tokens integer

prompt_tokens与completion_tokens的总和。

completion_tokens_details object

使用Qwen-VL 模型时输出Token的细粒度分类。

属性

audio_tokens integer

该参数当前固定为null。

reasoning_tokens integer

该参数当前固定为null。

text_tokens integer

Qwen-VL 模型输出的文本的Token数。

prompt_tokens_details object

输入 Token 的细粒度分类。

属性

audio_tokens integer

该参数当前固定为null。

cached_tokens integer

命中 Cache 的 Token 数。Context Cache 详情请参见上下文缓存。

text_tokens integer

Qwen-VL 模型输入的文本转换为 Token 后的长度。

image_tokens integer

Qwen-VL 模型输入的图像转换为Token的长度。

video_tokens integer

Qwen-VL 模型输入的视频文件或者图像列表转换为Token后的长度。

cache_creation object

显式缓存创建信息。

属性

ephemeral_5m_input_tokens integer

用于创建5分钟有效期显式缓存的 Token 长度。

cache_creation_input_tokens integer

用于创建显式缓存的 Token 长度。

cache_type string

使用显式缓存时，参数值为ephemeral，否则该参数不存在。

chat响应chunk对象（流式输出）
 
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"","function_call":null,"refusal":null,"role":"assistant","tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"我是","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"来自","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"阿里","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"云的超大规模","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"语言模型，我","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"叫通义千","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"问。","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":null,"index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[{"delta":{"content":"","function_call":null,"refusal":null,"role":null,"tool_calls":null},"finish_reason":"stop","index":0,"logprobs":null}],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":null}
{"id":"chatcmpl-e30f5ae7-3063-93c4-90fe-beb5f900bd57","choices":[],"created":1735113344,"model":"qwen-plus","object":"chat.completion.chunk","service_tier":null,"system_fingerprint":null,"usage":{"completion_tokens":17,"prompt_tokens":22,"total_tokens":39,"completion_tokens_details":null,"prompt_tokens_details":{"audio_tokens":null,"cached_tokens":0}}}
id string

本次调用的唯一标识符。每个chunk对象有相同的 id。

choices array

模型生成内容的数组，可包含一个或多个choices对象。如果设置include_usage参数为true，则最后一个chunk为空。

属性

delta object

chat请求的增量对象。

属性

content string

chunk的消息内容。

reasoning_content string

模型的思维链内容。

function_call object

该值默认为null，请参考tool_calls参数。

audio object

使用 Qwen-Omni 模型时生成的回复。

属性

refusal object

该参数当前固定为null。

role string

增量消息对象的角色，只在第一个chunk中有值。

tool_calls array

模型回复的要调用的工具以及调用工具所需的参数。可以包含一个或多个工具响应对象。

属性

finish_reason string

有四种情况：

因触发输入参数中的stop条件，或自然停止输出时为stop；

当生成未结束时为null；

因生成长度过长而结束为length；

因需要调用工具而结束为tool_calls。

index integer

当前响应在choices列表中的序列编号。当输入参数 n 大于1时，您需要根据 index 参数来进行不同响应对应的完整内容的拼接。

logprobs object

当前 choices 对象的概率信息。

属性

created integer

本次chat请求被创建时的时间戳。每个chunk对象有相同的时间戳。

model string

本次chat请求使用的模型名称。

object string

始终为chat.completion.chunk。

service_tier string

该参数当前固定为null。

system_fingerprintstring

该参数当前固定为null。

usage object

本次chat请求使用的Token信息。只在include_usage为true时，在最后一个chunk显示。

属性

completion_tokens integer

模型生成回复转换为 Token 后的长度。

prompt_tokens integer

用户的输入转换成 Token 后的长度。

total_tokens integer

prompt_tokens与completion_tokens的总和。

completion_tokens_details object

输出转换为 Token 后的详细信息。

属性

audio_tokens integer

Qwen-Omni 模型输出的音频转换为 Token 后的长度。

reasoning_tokens integer

Qwen3 模型思考过程转换为 Token 后的长度。

text_tokens integer

Qwen-VL 模型、QVQ模型、Qwen-Omni 模型输出的文本转换为 Token 后的长度。

prompt_tokens_details object

输入数据的 Token 细粒度分类。

属性

audio_tokens integer

使用Qwen-Omni 模型时，输入的音频转换为 Token 后的长度。

视频文件中的音频转换为 Token 后的长度会在该参数中体现。
text_tokens integer

使用Qwen-Omni 模型时，输入的文本转换为 Token 后的长度。

video_tokens integer

使用Qwen-VL 模型、QVQ模型、Qwen-Omni 模型时，输入的视频（图片列表形式或视频文件）转换为 Token 后的长度。如果Qwen-Omni 模型输入的是视频文件，则video_tokens 不包含音频的 Token，音频的 Token 在audio_tokens中体现。

image_tokens integer

使用Qwen-VL 模型、QVQ模型、Qwen-Omni 模型时，输入的图片转换为 Token 后的长度。

cached_tokens integer

命中 Cache 的 Token 数。Context Cache 详情请参见上下文缓存。

cache_creation object

显式缓存创建信息。

属性

cache_creation_input_tokens integer

用于创建显式缓存的 Token 长度。

cache_type string

使用显式缓存时，参数值为ephemeral，否则该参数不存在




2）通义千问-文生图API参考
更新时间：2025-09-24 00:20
产品详情
社区
通义千问-文生图模型（Qwen-Image）是一款通用图像生成模型，支持多种艺术风格，尤其擅长复杂文本渲染，特别是中英文文本渲染。模型支持多行布局、段落级文本生成以及细粒度细节刻画，可实现复杂的图文混合布局设计。

模型概览
模型效果



输入提示词

输出图像

Healing-style hand-drawn poster featuring three puppies playing with a ball on lush green grass, adorned with decorative elements such as birds and stars. The main title “Come Play Ball!” is prominently displayed at the top in bold, blue cartoon font. Below it, the subtitle “Come [Show Off Your Skills]!” appears in green font. A speech bubble adds playful charm with the text: “Hehe, watch me amaze my little friends next!” At the bottom, supplementary text reads: “We get to play ball with our friends again!” The color palette centers on fresh greens and blues, accented with bright pink and yellow tones to highlight a cheerful, childlike atmosphere.


计费与限流

当前qwen-image-plus与qwen-image能力相同，但qwen-image-plus价格更优惠。

新加坡地域北京地域
模型名称

计费单价

限流（主账号与RAM子账号共用）

免费额度

任务下发接口RPS限制

同时处理中任务数量

qwen-image-plus

$0.03/张

2

2

免费额度：各100张

有效期：阿里云百炼开通后90天内

qwen-image

$0.035/张

2

2

前提条件
在调用前，您需要根据地域获取API Key，再配置API Key到环境变量。

重要
北京和新加坡地域拥有独立的 API Key 与请求地址，不可混用，跨地域调用将导致鉴权失败或服务报错。

同步接口（推荐）
HTTP调用
通义千问Qwen-image模型支持同步接口，发送HTTP请求后立即返回结果。

新加坡地域：POST https://dashscope-intl.aliyuncs.com/api/v1/services/aigc/multimodal-generation/generation

北京地域：POST https://dashscope.aliyuncs.com/api/v1/services/aigc/multimodal-generation/generation

请求参数
文生图
 
curl --location 'https://dashscope-intl.aliyuncs.com/api/v1/services/aigc/multimodal-generation/generation' \
--header 'Content-Type: application/json' \
--header "Authorization: Bearer $DASHSCOPE_API_KEY" \
--data '{
    "model": "qwen-image-plus",
    "input": {
      "messages": [
        {
          "role": "user",
          "content": [
            {
              "text": "Healing-style hand-drawn poster featuring three puppies playing with a ball on lush green grass, adorned with decorative elements such as birds and stars. The main title “Come Play Ball!” is prominently displayed at the top in bold, blue cartoon font. Below it, the subtitle “Come [Show Off Your Skills]!” appears in green font. A speech bubble adds playful charm with the text: “Hehe, watch me amaze my little friends next!” At the bottom, supplementary text reads: “We get to play ball with our friends again!” The color palette centers on fresh greens and blues, accented with bright pink and yellow tones to highlight a cheerful, childlike atmosphere."
            }
          ]
        }
      ]
    },
    "parameters": {
      "negative_prompt": "",
      "prompt_extend": true,
      "watermark": false,
      "size": "1328*1328"
    }
}'

通过 negative_prompt 指定生成的图片避免出现“人物”元素。

新加坡和北京地域的API Key不同，获取API Key
以下为新加坡地域url，若使用北京地域的模型，需将url替换为：https://dashscope.aliyuncs.com/api/v1/services/aigc/video-generation/video-synthesis
 
curl -X POST https://dashscope-intl.aliyuncs.com/api/v1/services/aigc/text2image/image-synthesis \
    -H 'X-DashScope-Async: enable' \
    -H "Authorization: Bearer $DASHSCOPE_API_KEY" \
    -H 'Content-Type: application/json' \
    -d '{
    "model": "wan2.2-t2i-flash",
    "input": {
        "prompt": "雪地，白色小教堂，极光，冬日场景，柔和的光线。",
        "negative_prompt": "人物"
    },
    "parameters": {
        "size": "1024*1024",
        "n": 1
    }
}'


请求头（Headers）
Content-Type string （必选）

请求内容类型。此参数必须设置为application/json。

Authorization string（必选）

请求身份认证。接口使用阿里云百炼API-Key进行身份认证。示例值：Bearer sk-xxxx。

请求体（Request Body）
model string （必选）

模型名称。设置为qwen-image-plus或qwen-image。

input object （必选）

输入的基本信息，如提示词等。

属性

messages array （必选）

模型对话列表。目前仅支持单轮对话，即传入一组role、content参数，不支持多轮对话。

属性

role string （必选）

消息的角色。此参数必须设置为user。

content list （必选）

消息的内容，包括图像与提示词。注意：content只能包含一个text。

属性

text string （必选）

正向提示词，用来描述生成图像中期望包含的元素和视觉特点。

支持中英文，长度不超过800个字符，每个汉字/字母占一个字符，超过部分会自动截断。

示例值：一只坐着的橘黄色的猫，表情愉悦，活泼可爱，逼真准确。

注意：仅支持传入一个text，不传或传入多个将报错。

parameters object （可选）

图像处理参数。

属性

negative_prompt string （可选）

反向提示词，用来描述不希望在画面中看到的内容，可以对画面进行限制。

支持中英文，长度不超过500个字符，超过部分会自动截断。

示例值：低分辨率、错误、最差质量、低质量、残缺、多余的手指、比例不良等。

size string （可选）

输出图像的分辨率，格式为宽*高。默认分辨率为1328*1328。

可选的分辨率及其对应的图像宽高比例为：

1664*928：16:9。

1472*1140：4:3 。

1328*1328（默认值）：1:1。

1140*1472：3:4。

928*1664：9:16

n integer （可选）

生成图片的数量。默认值为1。

注意：当前仅支持生成1张图像，设置其他数值将报错。

prompt_extend bool （可选）

是否开启prompt智能改写。开启后会使用大模型对输入prompt进行智能改写，仅对正向提示词有效。对于较短的输入prompt生成效果提升明显，但会增加3-4秒耗时。

true：默认值，开启智能改写。

false：不开启智能改写。

watermark bool （可选）

是否添加水印标识，水印位于图片右下角，文案为“Qwen-Image生成”。

false：默认值，不添加水印。

true：添加水印。

seed integer （可选）

随机数种子。取值范围是[0, 2147483647]。

如果不提供，则算法自动生成一个随机数作为种子。如果希望生成内容保持相对稳定，请使用相同的seed参数值。

提示：模型生成过程具有概率性，因此即使使用相同的 seed，也不能保证每次生成结果完全一致。

响应参数
任务执行成功任务执行异常
任务数据（如任务状态、图像URL等）仅保留24小时，超时后会被自动清除。请您务必及时保存生成的图像。

 
{
    "output": {
        "choices": [
            {
                "finish_reason": "stop",
                "message": {
                    "role": "assistant",
                    "content": [
                        {
                            "image": "https://dashscope-result-sz.oss-cn-shenzhen.aliyuncs.com/xxx.png?Expires=xxxx"
                        }
                    ]
                }
            }
        ],
        "task_metric": {
            "TOTAL": 1,
            "FAILED": 0,
            "SUCCEEDED": 1
        }
    },
    "usage": {
        "width": 1328,
        "image_count": 1,
        "height": 1328
    },
    "request_id": "7a270c86-db58-9faf-b403-xxxxxx"
}
output object

任务输出信息。

属性

choices array

模型生成的内容，类型为的数组，可以包含一个或多个choices对象。

属性

finish_reason string

自然停止时输出为stop。

messages object

输出的消息。

属性

role string

消息的角色，固定为assistant。

content array

属性

image string

模型生成图片的URL地址。有效期24小时，请及时下载并保存图像。

task_metrics object

任务结果统计。

属性

TOTAL integer

总的任务数。

SUCCEEDED integer

任务状态为成功的任务数。

FAILED integer

任务状态为失败的任务数。

usage object

输出信息统计。只对成功的结果计数。

属性

image_count integer

模型生成图片的数量。

当前固定为1。
width integer

模型生成图片的宽度，单位像素。

height integer

模型生成图片的高度，单位像素。

request_id string

请求唯一标识。可用于请求明细溯源和问题排查。

code string

请求失败的错误码。请求成功时不会返回此参数，详情请参见错误信息。

message string

请求失败的详细信息。请求成功时不会返回此参数，详情请参见错误信息。

异步接口（两步获取结果）
HTTP调用
通义千问Qwen-Image模型还支持异步接口，HTTP调用流程分两步：

创建任务获取任务ID：发送一个请求创建任务，该请求会返回任务ID（task_id）。

根据任务ID查询结果：使用task_id轮询任务状态，直到任务完成并获得图像URL。

步骤1：创建任务获取任务ID
新加坡地域：POST https://dashscope-intl.aliyuncs.com/api/v1/services/aigc/text2image/image-synthesis

北京地域：POST https://dashscope.aliyuncs.com/api/v1/services/aigc/text2image/image-synthesis

说明
任务创建成功后，接口将返回task_id。task_id查询有效期为 24 小时。

请求参数
文生图
 
curl -X POST https://dashscope-intl.aliyuncs.com/api/v1/services/aigc/text2image/image-synthesis \
    -H 'X-DashScope-Async: enable' \
    -H "Authorization: Bearer $DASHSCOPE_API_KEY" \
    -H 'Content-Type: application/json' \
    -d '{
    "model": "qwen-image-plus",
    "input": {
        "prompt": "Healing-style hand-drawn poster featuring three puppies playing with a ball on lush green grass, adorned with decorative elements such as birds and stars. The main title “Come Play Ball!” is prominently displayed at the top in bold, blue cartoon font. Below it, the subtitle “Come [Show Off Your Skills]!” appears in green font. A speech bubble adds playful charm with the text: “Hehe, watch me amaze my little friends next!” At the bottom, supplementary text reads: “We get to play ball with our friends again!” The color palette centers on fresh greens and blues, accented with bright pink and yellow tones to highlight a cheerful, childlike atmosphere."
    },
    "parameters": {
        "size": "1328*1328",
        "n": 1,
        "prompt_extend": true,
        "watermark": false
    }
}'        
请求头（Headers）
Content-Type string （必选）

请求内容类型。此参数必须设置为application/json。

Authorization string（必选）

请求身份认证。接口使用阿里云百炼API-Key进行身份认证。示例值：Bearer sk-xxxx。

X-DashScope-Async string （必选）

异步处理配置参数。HTTP请求只支持异步，必须设置为enable。

重要
缺少此请求头将报错：“current user api does not support synchronous calls”。

请求体（Request Body）
model string （必选）

模型名称。设置为qwen-image-plus或qwen-image。

input object （必选）

输入的基本信息，如提示词等。

属性

prompt string （必选）

正向提示词，用来描述生成图像中期望包含的元素和视觉特点。

支持中英文，长度不超过800个字符，每个汉字/字母占一个字符，超过部分会自动截断。

示例值：一只坐着的橘黄色的猫，表情愉悦，活泼可爱，逼真准确。

negative_prompt string （可选）

反向提示词，用来描述不希望在画面中看到的内容，可以对画面进行限制。

支持中英文，长度不超过500个字符，超过部分会自动截断。

示例值：低分辨率、错误、最差质量、低质量、残缺、多余的手指、比例不良等。

parameters object （可选）

图像处理参数。

属性

size string （可选）

输出图像的分辨率，格式为宽*高。默认分辨率为1328*1328。

可选的分辨率及其对应的图像宽高比例为：

1664*928：16:9。

1472*1140：4:3 。

1328*1328（默认值）：1:1。

1140*1472：3:4。

928*1664：9:16

n integer （可选）

生成图片的数量。默认值为1。

注意：当前仅支持生成1张图像，设置其他数值将报错。

prompt_extend bool （可选）

是否开启prompt智能改写。开启后会使用大模型对输入prompt进行智能改写，仅对正向提示词有效。对于较短的输入prompt生成效果提升明显，但会增加3-4秒耗时。

true：默认值，开启智能改写。

false：不开启智能改写。

watermark bool （可选）

是否添加水印标识，水印位于图片右下角，文案为“Qwen-Image生成”。

false：默认值，不添加水印。

true：添加水印。

seed integer （可选）

随机数种子，用于控制模型生成内容的随机性。

seed参数取值范围是[0, 2147483647]。如果不提供，则算法自动生成一个随机数作为种子。

如果您希望生成内容保持相对稳定，请使用相同的seed参数值。

响应参数
成功响应异常响应
请保存 task_id，用于查询任务状态与结果。

 
{
    "output": {
        "task_status": "PENDING",
        "task_id": "0385dc79-5ff8-4d82-bcb6-xxxxxx"
    },
    "request_id": "4909100c-7b5a-9f92-bfe5-xxxxxx"
}
output object

任务输出信息。

属性

task_id string

任务ID。查询有效期24小时。

task_status string

任务状态。

枚举值

PENDING：任务排队中

RUNNING：任务处理中

SUCCEEDED：任务执行成功

FAILED：任务执行失败

CANCELED：任务已取消

UNKNOWN：任务不存在或状态未知

request_id string

请求唯一标识。可用于请求明细溯源和问题排查。

code string

请求失败的错误码。请求成功时不会返回此参数，详情请参见错误信息。

message string

请求失败的详细信息。请求成功时不会返回此参数，详情请参见错误信息。

步骤2：根据任务ID查询结果
GET https://dashscope-intl.aliyuncs.com/api/v1/tasks/{task_id}

以上为新加坡地域url，若使用北京地域的模型，需将url替换为：https://dashscope.aliyuncs.com/api/v1/tasks/{task_id}
说明
模型耗时约15秒。建议采用轮询机制，并设置合理的查询间隔（如3秒）来获取结果。实际耗时受排队任务数量和网络状况影响，请您在获取结果时耐心等待。

task_id 查询有效期为24小时，超时后将无法查询结果，接口将返回任务状态为UNKNOWN。

任务成功后返回的 url有效期为24小时，请及时下载并保存图像。


通义万相-文生图V2版API参考
更新时间：2025-09-26 14:05
产品详情
社区
通义万相-文生图模型基于文本生成图像，支持多种艺术风格与写实摄影效果，满足多样化创意需求。

快速入口：通义万相官网在线体验

说明
通义万相官网的功能与API支持的能力可能存在差异，具体以API文档中列出的能力为准。如有新增功能，API文档会及时更新，敬请关注。

模型概览



模型名称

模型简介

输出图像格式

wan2.5-t2i-preview 推荐

万相2.5 preview

取消单边限制，在总像素面积与宽高比约束内，自由选尺寸

例如，支持768*2700，而2.2 及以下版本单边上限 1400
图像分辨率：总像素在[768*768, 1440*1440]之间

图像宽高比：[1:4, 4:1]
图像格式：png

wan2.2-t2i-flash 推荐

万相2.2极速版

较2.1模型速度提升50%

图像分辨率：宽高均在[512, 1440]像素之间

图像格式：png

wan2.2-t2i-plus 推荐

万相2.2专业版

较2.1模型稳定性与成功率全面提升

wanx2.1-t2i-turbo

万相2.1极速版

wanx2.1-t2i-plus

万相2.1专业版

wanx2.0-t2i-turbo

万相2.0极速版

说明
调用前，请查阅各地域支持的模型列表与价格。

前提条件
在调用前，先获取API Key，再配置API Key到环境变量。如需通过SDK进行调用，请安装DashScope SDK。

重要
北京和新加坡地域拥有独立的 API Key 与请求地址，不可混用，跨地域调用将导致鉴权失败或服务报错。

HTTP调用
由于文生图任务耗时较长（通常为1-2分钟），API采用异步调用。整个流程包含 “创建任务 -> 轮询获取” 两个核心步骤，具体如下：

具体耗时受限于排队任务数和服务执行情况，请在获取结果时耐心等待。
步骤1：创建任务获取任务ID
新加坡地域：POST https://dashscope-intl.aliyuncs.com/api/v1/services/aigc/text2image/image-synthesis

北京地域：POST https://dashscope.aliyuncs.com/api/v1/services/aigc/text2image/image-synthesis

说明
创建成功后，使用接口返回的 task_id 查询结果，task_id 有效期为 24 小时。请勿重复创建任务，轮询获取即可。

请求参数
文生图文生图（使用反向提示词）
新加坡和北京地域的API Key不同，获取API Key
以下为新加坡地域url，若使用北京地域的模型，需将url替换为：https://dashscope.aliyuncs.com/api/v1/services/aigc/video-generation/video-synthesis
 
curl -X POST https://dashscope-intl.aliyuncs.com/api/v1/services/aigc/text2image/image-synthesis \
    -H 'X-DashScope-Async: enable' \
    -H "Authorization: Bearer $DASHSCOPE_API_KEY" \
    -H 'Content-Type: application/json' \
    -d '{
    "model": "wan2.5-t2i-preview",
    "input": {
        "prompt": "一间有着精致窗户的花店，漂亮的木质门，摆放着花朵"
    },
    "parameters": {
        "size": "1024*1024",
        "n": 1
    }
}'    
请求头（Headers）
Content-Type string （必选）

请求内容类型。此参数必须设置为application/json。

Authorization string（必选）

请求身份认证。接口使用阿里云百炼API-Key进行身份认证。示例值：Bearer sk-xxxx。

X-DashScope-Async string （必选）

异步处理配置参数。HTTP请求只支持异步，必须设置为enable。

重要
缺少此请求头将报错：“current user api does not support synchronous calls”。

请求体（Request Body）
model string （必选）

模型名称。示例值：wan2.5-t2i-preview。

各模型信息详见模型列表与价格。

input object （必选）

输入的基本信息，如提示词等。

属性

prompt string （必选）

正向提示词，用来描述生成图像中期望包含的元素和视觉特点。

支持中英文，每个汉字/字母占一个字符，超过部分会自动截断。长度限制因模型版本而异：

wan2.5-t2i-preview：长度不超过2000个字符。

wan2.2及以下版本模型：长度不超过800个字符。

示例值：一只坐着的橘黄色的猫，表情愉悦，活泼可爱，逼真准确。

提示词的使用技巧请参见文生图Prompt指南。

negative_prompt string （可选）

反向提示词，用来描述不希望在画面中看到的内容，可以对画面进行限制。

支持中英文，长度不超过500个字符，超过部分会自动截断。

示例值：低分辨率、错误、最差质量、低质量、残缺、多余的手指、比例不良等。

parameters object （可选）

图像处理参数。如设置图像分辨率、开启prompt智能改写、添加水印等。

属性

size string （可选）

输出图像的分辨率，格式为宽*高。默认值和约束因模型版本而异：

wan2.5-t2i-preview：默认值为 1280*1280。总像素在 [768*768, 1440*1440] 之间且宽高比范围为 [1:4, 4:1]。例如，768*2700符合要求。

wan2.2及以下版本模型：默认值为1024*1024。图像宽高在[512, 1440]之间，最大分辨率为1440*1440。例如， 768*2700超单边限制，不支持。

示例值：1280*1280。

常见比例推荐分辨率

1:1：1280*1280 或 1024*1024

2:3：800*1200

3:2：1200*800

3:4：960*1280

4:3：1280*960

9:16：720*1280

16:9：1280*720

21:9：1344*576

n integer （可选）

重要
n直接影响费用。费用 = 单价 × 图片张数，请在调用前确认模型价格。

生成图片的数量。取值范围为1~4张，默认为4。测试阶段建议设置为1，便于低成本验证。

prompt_extend boolean （可选）

是否开启prompt智能改写。开启后使用大模型对输入prompt进行智能改写。对于较短的prompt生成效果提升明显，但会增加耗时。

true：开启智能改写。

false：不开启智能改写。

该参数的默认值因模型版本而异：

wan2.5-t2i-preview：默认值为false。

wan2.2及以下版本模型：默认值为true。

示例值：true。

watermark boolean （可选）

是否添加水印标识，水印位于图片右下角，文案固定为“AI生成”。

false：默认值，不添加水印。

true：添加水印。

seed integer （可选）

随机数种子，取值范围是[0, 2147483647]。

如果不提供，则算法自动生成一个随机数作为种子。如果提供，则根据n的值分别为n张图片生成seed参数，例如n=4，算法将分别生成seed、seed+1、seed+2、seed+3作为参数的图片。

若需提升生成结果的可复现性，建议固定seed值。

请注意，由于模型生成具有概率性，即使使用相同 seed，也不能保证每次生成结果完全一致。

响应参数
成功响应异常响应
请保存 task_id，用于查询任务状态与结果。

 
{
    "output": {
        "task_status": "PENDING",
        "task_id": "0385dc79-5ff8-4d82-bcb6-xxxxxx"
    },
    "request_id": "4909100c-7b5a-9f92-bfe5-xxxxxx"
}
output object

任务输出信息。

属性

task_id string

任务ID。查询有效期24小时。

task_status string

任务状态。

枚举值

PENDING：任务排队中

RUNNING：任务处理中

SUCCEEDED：任务执行成功

FAILED：任务执行失败

CANCELED：任务已取消

UNKNOWN：任务不存在或状态未知

request_id string

请求唯一标识。可用于请求明细溯源和问题排查。

code string

请求失败的错误码。请求成功时不会返回此参数，详情请参见错误信息。

message string

请求失败的详细信息。请求成功时不会返回此参数，详情请参见错误信息。

步骤2：根据任务ID查询结果
新加坡地域：GET https://dashscope-intl.aliyuncs.com/api/v1/tasks/{task_id}

北京地域：GET https://dashscope.aliyuncs.com/api/v1/tasks/{task_id}

说明
轮询建议：图像生成过程约需数分钟，建议采用轮询机制，并设置合理的查询间隔（如 10 秒）来获取结果。

任务状态流转：PENDING（排队中）→ RUNNING（处理中）→ SUCCEEDED（成功）/ FAILED（失败）。

结果链接：任务成功后返回图像链接，有效期为 24 小时。建议在获取链接后立即下载并转存至永久存储（如阿里云 OSS）。

请求参数
查询任务结果
请将86ecf553-d340-4e21-xxxxxxxxx替换为真实的task_id。

新加坡和北京地域的API Key不同。获取API Key。
以下为新加坡地域base_url，若使用北京地域的模型，需将base_url替换为https://dashscope.aliyuncs.com/api/v1/tasks/86ecf553-d340-4e21-xxxxxxxxx
 
curl -X GET https://dashscope-intl.aliyuncs.com/api/v1/tasks/86ecf553-d340-4e21-xxxxxxxxx \
--header "Authorization: Bearer $DASHSCOPE_API_KEY"
请求头（Headers）
Authorization string（必选）

请求身份认证。接口使用阿里云百炼API-Key进行身份认证。示例值：Bearer sk-xxxx。

URL路径参数（Path parameters）
task_id string（必选）

任务ID。

响应参数
任务执行成功任务执行失败任务部分失败任务查询过期
图像URL仅保留24小时，超时后会被自动清除，请及时保存生成的图像。

 
{
    "request_id": "f767d108-7d50-908b-a6d9-xxxxxx",
    "output": {
        "task_id": "d492bffd-10b5-4169-b639-xxxxxx",
        "task_status": "SUCCEEDED",
        "submit_time": "2025-01-08 16:03:59.840",
        "scheduled_time": "2025-01-08 16:03:59.863",
        "end_time": "2025-01-08 16:04:10.660",
        "results": [
            {
                "orig_prompt": "一间有着精致窗户的花店，漂亮的木质门，摆放着花朵",
                "actual_prompt": "一间有着精致雕花窗户的花店，漂亮的深色木质门上挂着铜制把手。店内摆放着各式各样的鲜花，包括玫瑰、百合和向日葵，色彩鲜艳，生机勃勃。背景是温馨的室内场景，透过窗户可以看到街道。高清写实摄影，中景构图。",
                "url": "https://dashscope-result-wlcb.oss-cn-wulanchabu.aliyuncs.com/1.png"
            }
        ],
        "task_metrics": {
            "TOTAL": 1,
            "SUCCEEDED": 1,
            "FAILED": 0
        }
    },
    "usage": {
        "image_count": 1
    }
}
output object

任务输出信息。

属性

task_id string

任务ID。查询有效期24小时。

task_status string

任务状态。

枚举值

PENDING：任务排队中

RUNNING：任务处理中

SUCCEEDED：任务执行成功

FAILED：任务执行失败

CANCELED：任务已取消

UNKNOWN：任务不存在或状态未知

轮询过程中的状态流转：

PENDING（排队中） → RUNNING（处理中）→ SUCCEEDED（成功）/ FAILED（失败）。

初次查询状态通常为 PENDING（排队中）或 RUNNING（处理中）。

当状态变为 SUCCEEDED 时，响应中将包含生成的图像url。

若状态为 FAILED，请检查错误信息并重试。

submit_time string

任务提交时间。格式为 YYYY-MM-DD HH:mm:ss.SSS。

scheduled_time string

任务执行时间。格式为 YYYY-MM-DD HH:mm:ss.SSS。

end_time string

任务完成时间。格式为 YYYY-MM-DD HH:mm:ss.SSS。

results array of object

任务结果列表，包括图像URL、prompt、部分任务执行失败报错信息等。

数据结构

属性

orig_prompt string

原始输入的prompt，对应请求参数prompt。

actual_prompt string

开启 prompt 智能改写后，返回实际使用的优化后 prompt。若未开启该功能，则不返回此字段。

url string

图像URL地址。仅在 task_status 为 SUCCEEDED 时返回。链接有效期24小时，可通过此URL下载图像。

code string

请求失败的错误码。请求成功时不会返回此参数，详情请参见错误信息。

message string

请求失败的详细信息。请求成功时不会返回此参数，详情请参见错误信息。

task_metrics object

任务结果统计。

属性

TOTAL integer

总的任务数。

SUCCEEDED integer

任务状态为成功的任务数。

FAILED integer

任务状态为失败的任务数。

code string

请求失败的错误码。请求成功时不会返回此参数，详情请参见错误信息。

message string

请求失败的详细信息。请求成功时不会返回此参数，详情请参见错误信息。

usage object

输出信息统计。只对成功的结果计数。

属性

image_count integer

模型成功生成图片的数量。计费公式：费用 = 图片数量 × 单价。

request_id string

请求唯一标识。可用于请求明细溯源和问题排查。


